$(document).ready(function(){setTimeout(hideAlert,2000);$("#scheduleAppointmentModal").on("show.bs.modal",function(c){var b=$(this);var a=$(c.relatedTarget);
var d=a.attr("datetime");getScheduleAppointmentForm(d,b);});$("#clearBlockedTimeModal").on("show.bs.modal",function(c){var b=$(this);var a=$(c.relatedTarget);
b.find(".cancel-this-appointment").click(function(){$.ajax({type:"POST",url:"/admin/cancelAppointment",data:{c:a.attr("c")}}).done(function(){location.reload();
});});});});function hideAlert(){$(".alert").slideUp();}function getTimeSlotOptions(){var a=$("#services").val();var b=$("#dateOfAppointment").val();if(a!="Choose a service..."){$.ajax({type:"POST",url:"/admin/getTimeSlotOptions",data:{sId:a,aDate:b}}).done(function(c){if(c.indexOf("ERROR")>-1){$("#bookForClientButton").html("Error");
$("#bookForClientButton").addClass("error-button");}else{$("#timeSlots").html(c);$("#bookForClientButton").html("Book Appointment");$("#bookForClientButton").removeClass("error-button");
}});}}function getScheduleAppointmentForm(b,a){$.ajax({type:"POST",url:"/admin/getScheduleAppointmentForm",data:{d:b}}).done(function(c){if(c.indexOf("ERROR")===-1){$(".modal-body").html(c);
}});}function getTimeSlotOptionsForRescheduledAppointment(b){var a=$("#servicesForRescheduledAppointment-"+b).val();var c=$("#dateOfRescheduledAppointment-"+b).val();
if(a!="Choose a service..."){$.ajax({type:"POST",url:"/admin/getTimeSlotOptions",data:{sId:a,aDate:c}}).done(function(d){if(d.indexOf("ERROR")>-1){$("#timeSlotsForRescheduledAppointment-"+b).html("<option>No times available</option>");
}else{$("#timeSlotsForRescheduledAppointment-"+b).html(d);}});}}$(document).on("click","#addClient",function(a){$.ajax({type:"POST",url:"/admin/getClientDataForm"}).done(function(b){if(b.indexOf("ERROR")>-1){alert("An error has occured. Please try again.");
}else{$("#lastNameFilters").slideUp();$("#clientsDetailsSelector").slideUp();$("#clientDetails").slideUp();$("#addClient").fadeOut();$("#clientInfoForm").html(b).slideDown();
}});});$(document).on("click","#editClient",function(b){var a=$("#clientsDetailsSelector").val();$.ajax({type:"POST",url:"/admin/getClientDataForm",data:{cId:a}}).done(function(c){if(c.indexOf("ERROR")>-1){alert("Dang... you broke it.");
}else{$("#lastNameFilters").slideUp();$("#clientsDetailsSelector").slideUp();$("#clientDetails").slideUp();$("#addClient").fadeOut();$("#clientInfoForm").html(c).slideDown();
}});});$(document).on("click",".last-name-filter",function(b){var a=$(b.currentTarget).attr("value");$("#clientsDetailsSelector").slideDown();if(a==="Reset"){getClientSelectMenuData();
$(".reset-search").fadeOut();}else{$(".reset-search").fadeIn();getClientSelectMenuData(a);}});function getClientSelectMenuData(a){$.ajax({type:"POST",url:"/admin/getClientsSelectMenu",data:{lastNameStartsWith:a}}).done(function(b){var c=b.search('"success":false');
if(c===-1){$("#clientsDetailsSelector").html(b);}});}$(document).on("click","#saveClientButton",function(h){var f=$("#e").val();var i=$("#e2").val();var d=$("#p").val();
var g=$("#f").val();var c=$("#l").val();var b=$("#ph").val();var a=$("#cId").val();if(f&&d&&g&&c){$("#saveClientButton .label").hide();$("#saveClientButton .spinner").show();
$.ajax({type:"POST",url:"/admin/saveClient",data:{email:f,hp:i,password:d,firstName:g,lastName:c,phoneNumber:b,cId:a}}).done(function(e){var j=e.search('"success":false');
if(j===-1){hideClientRegistrationForm();alert("User saved!");}});}});$(document).on("click","#cancelClientRegistrationButton",function(a){hideClientRegistrationForm();
});function hideClientRegistrationForm(){$("#clientInfoForm").slideUp();$("#clientsDetailsSelector").slideDown();$("#lastNameFilters").slideDown();$("#clientDetails").slideDown();
$("#addClient").fadeIn();}$(document).on("change","#clientsDetailsSelector",function(){$(this).slideUp();$(".reset-search").fadeIn();var a=$(this).val();
$.ajax({type:"POST",url:"/admin/getClientDetails",data:{cId:a}}).done(function(b){var c=b.search('"success":false');if(c===-1){$("#clientDetails").html(b).fadeIn();
}});});$(document).on("click","#saveTextButton",function(b){var a=$("#homepageText").val();$.ajax({type:"POST",url:"/admin/saveHomepageMessage",data:{m:a}}).done(function(c){var d=JSON.parse(c);
if(d.success===true){$("#saveTextButton").html("Success");$("#saveTextButton").removeClass("error-button");}else{$("#saveTextButton").html("Error");$("#saveTextButton").addClass("error-button");
}window.location.reload();});});$(document).on("click","#saveClientNotesButton",function(b){var a=encodeURIComponent($("#clientNotes").val());$.ajax({type:"POST",url:"/admin/saveClientNotes",data:{n:a}});
});$(document).on("click","#blockOffTimeButton",function(c){var a=$("#chooseDateToBlockOff").val();var i=$("#fromHour").val();var f=$("#fromMinute").val();
var j=$("#fromMorningOrAfternoon").val();var d=$("#toHour").val();var k=$("#toMinute").val();var b=$("#toMorningOrAfternoon").val();var h=i+":"+f+j;var g=d+":"+k+b;
$("#blockOffTimeButton").html($("#waitingSpinner").html());$.ajax({type:"POST",url:"/admin/saveBlockedTime",data:{date:a,from:h,to:g}}).done(function(e){var l=JSON.parse(e);
if(l.success===true){$("#blockOffTimeButton").html("Success");$("#blockOffTimeButton").removeClass("error-button");}else{$("#blockOffTimeButton").html("Error");
$("#blockOffTimeButton").addClass("error-button");}});});$(document).on("click","#blockOffDaysButton",function(a){var c=$("#fromWholeDay").val();var b=$("#toWholeDay").val();
$(this).html($("#waitingSpinner").html());$.ajax({type:"POST",url:"/admin/blockOffWholeDay",data:{from:c,to:b}}).done(function(d){var e=JSON.parse(d);if(e.success===true){$("#blockOffDaysButton").html("Success");
$("#blockOffDaysButton").removeClass("error-button");}else{$("#blockOffDaysButton").html("Error");$("#blockOffDaysButton").addClass("error-button");}});
});$(document).on("click",".blocked-time",function(c){var b=$(this).find("input:checkbox");var a=$(this);if(c.target.type!=="checkbox"){$(b).trigger("click");
}var d=$(b).is(":checked");if(d===true){$(a).addClass("deleted");}else{$(a).removeClass("deleted");}});$(document).on("click","#deleteBlockedTimeslotsButton",function(b){var a=$("#deleteBlockedTimeslotsButton");
$(a).html($("#waitingSpinner").html());$(".blocked-timeslots-table tr:hidden").remove();$.ajax({type:"POST",url:"/admin/clearBlockedTime",data:$("#blockedTimesForm").serialize()}).done(function(c){var d=JSON.parse(c);
if(d.success===true){$(a).html("Success");$(a).removeClass("error-button");var f=d.deletedTimeslots;var g=f.length;for(var e=0;e<g;e++){$("#blockedTime"+f[e]).fadeOut("slow");
}}else{$(a).html("Error");$(a).addClass("error-button");}});});$(document).on("click","#recurringAppointment",function(){var a=$(".recurringAppointmentAdminOptions");
if($(a).is(":visible")){$(a).fadeOut();}else{$(a).fadeIn();}});$(document).on("change","#services",function(){getTimeSlotOptions();});$(document).on("change","#dateOfAppointment",function(){getTimeSlotOptions();
});function getRescheduleOptions(a){$.ajax({type:"POST",url:"/admin/getRescheduleOptions",data:{aId:a}}).done(function(b){if(b.indexOf("ERROR")===-1){$("#edit-appointment-options").html(b);
$("#dateOfRescheduledAppointment-"+a).datepicker({minDate:0,showButtonPanel:true});var c=$("#dateOfRescheduledAppointment-"+a).attr("date");$("#dateOfRescheduledAppointment-"+a).datepicker("setDate",new Date(c));
$("#servicesForRescheduledAppointment-"+a).on("change",function(){getTimeSlotOptionsForRescheduledAppointment(a);});$("#dateOfRescheduledAppointment-"+a).on("change",function(){getTimeSlotOptionsForRescheduledAppointment(a);
});$("#rescheduleButton-"+a).on("click",function(){rescheduleAppointment(a);});}});}function rescheduleAppointment(a){var c=$("#servicesForRescheduledAppointment-"+a).val();
var d=$("#dateOfRescheduledAppointment-"+a).val();var b=$("#timeSlotsForRescheduledAppointment-"+a).val();$("#rescheduleButton-"+a).html($(".spinner").html());
$.ajax({type:"POST",url:"/admin/rescheduleAppointment",data:{aId:a,sId:c,aDate:d,sTime:b}}).done(function(e){var f=JSON.parse(e);if(f.success===true){$("#rescheduleButton-"+a).html("Success");
$("#rescheduleButton-"+a).removeClass("error-button");setTimeout(function(){$("#rescheduleAppointmentModal").modal("toggle");},400);setTimeout(function(){window.location.reload();
},1250);}else{$("#rescheduleButton-"+a).html("Error");$("#rescheduleButton-"+a).addClass("error-button");}});}